<html>
  <head>
    <title>TV</title>
  </head>

  <body>
    <script src="https://cdn.jsdelivr.net/npm/mpegts.js@1.7.3/dist/mpegts.min.js"></script>
    <script src="http://cdn.dashjs.org/latest/dash.all.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <link href="https://vjs.zencdn.net/8.16.1/video-js.css" rel="stylesheet" />
    <script src="https://vjs.zencdn.net/8.16.1/video.min.js"></script>
    <script src="
https://cdn.jsdelivr.net/npm/umataste@0.0.1/dist/umataste.min.js
"></script>
  <style>
    .wrapper {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 10px;
  }
  video {
    width: 100%;
    max-height: 50vh;
  }
  .vjs-default-skin {
    width: 100%;
    max-height: 45vh;
  }
  </style>
    <div class="wrapper">
    <div>
    <h3>mpegts.js</h3>
    <video id="video1" controls></video>
  </div>
  <div>
    <h3>hls.js</h3>
    <video id="video2" controls muted></video>
  </div>
  <div>
    <h3>dash.js</h3>
    <video data-dashjs-player autoplay src="https://rtmp.howardchung.net/dash/tv.mpd" id="video3" controls muted></video>
  </div>
  <div>
    <h3>umataste (fmp4)</h3>
    <video id="video6" controls></video>
  </div>
  <div>
    <h3>video.js HLS</h3>
    <video-js class="vjs-default-skin" id="video4" controls muted>
      <source src="https://rtmp.howardchung.net/hls/tv.m3u8"></source>
    </video-js>
  </div>
  <div>
    <h3>video.js DASH</h3>
    <video-js class="vjs-default-skin" id="video5" controls muted>
      <source src="https://rtmp.howardchung.net/dash/tv.mpd"></source>
    </video-js>
  </div>
  </div>
    <script type="module">
    const mpegtsPlayer = mpegts.createPlayer({
      isLive: true,
      // liveBufferLatencyChasing: true,
      // enableStashBuffer: false,
      type: "mpegts",
      url: "https://rtmp.howardchung.net/mpegts",
    });
    const video1 = document.getElementById("video1");
    mpegtsPlayer.attachMediaElement(video1);
    mpegtsPlayer.load();
    tryPlay(video1);

    const hls = new Hls();
    const video2 = document.getElementById("video2");
    hls.loadSource('https://rtmp.howardchung.net/hls/tv.m3u8');
    hls.attachMedia(video2);
    hls.on(Hls.Events.MANIFEST_PARSED, function() {
      tryPlay(video2);
    });
    const vjs1 = videojs('video4');
    vjs1.play();
    const vjs2 = videojs('video5');
    vjs2.play();

    const video6 = document.getElementbyId("video6");
    const zlplayer = new window.umataste.MSEPlayer({ 
      // some options
    });
    zlplayer.attachMedia(video6);
    await zlplayer.load("https://rtmp.howardchung.net/fmp4");
    tryPlay(video6);
    
   async function tryPlay(vidEl) {
      try {
        await vidEl.play();
      } catch (e) {
        console.log('autoplay disabled, muting');
        vidEl.muted = true;
        await vidEl.play();
      }
    }
    </script>
  </body>
</html>
